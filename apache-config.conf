<VirtualHost *:80>
    ServerName university-canteen.onrender.com
    DocumentRoot /var/www/html
    
    # Enable rewrite module for clean URLs
    RewriteEngine On
    
    # Main directory settings
    <Directory "/var/www/html">
        Options -Indexes +FollowSymLinks +MultiViews
        AllowOverride All
        Require all granted
        DirectoryIndex index.php
    </Directory>

    # User app - accessible at /user
    Alias /user "/var/www/html/user_app"
    <Directory "/var/www/html/user_app">
        Options -Indexes +FollowSymLinks +MultiViews
        AllowOverride All
        Require all granted
        DirectoryIndex user_index.php index.php signin.php
    </Directory>

    # Admin app - accessible at /admin  
    Alias /admin "/var/www/html/admin_app"
    <Directory "/var/www/html/admin_app">
        Options -Indexes +FollowSymLinks +MultiViews
        AllowOverride All
        Require all granted
        DirectoryIndex admin_index.php adminsignin.php
    </Directory>

    # Shared resources (read-only)
    Alias /shared "/var/www/html/shared"
    <Directory "/var/www/html/shared">
        Options -Indexes
        AllowOverride None
        Require all granted
    </Directory>

    # MySQL/DB resources (block direct access)
    <Directory "/var/www/html/mysql">
        Options -Indexes
        AllowOverride None
        Require all denied
    </Directory>

    # PHP settings
    <FilesMatch "\.php$">
        SetHandler application/x-httpd-php
    </FilesMatch>

    # Error logging
    LogLevel warn
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
